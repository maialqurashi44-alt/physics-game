<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulation</title>

<style>
    body {
        margin: 0;
        background: #eee; /* رجعت الخلفية */
        overflow: hidden;
        font-family: sans-serif;
    }

    #controls, #massControls {
        position: absolute;
        top: 10px;
        background: white;
        padding: 12px;
        border-radius: 12px;
        box-shadow: 0 0 10px #0002;
        z-index: 10;
    }

    #controls {
        left: 10px; /* السرعات يسار */
    }

    #massControls {
        right: 10px; /* الكتلة يمين */
    }

    button, select {
        width: 100%;
        margin: 6px 0;
        padding: 8px;
        border-radius: 8px;
        border: 1px solid #ccc;
    }

    canvas {
        display: block;
    }
</style>
</head>
<body>

<div id="controls">
    <label>السرعة</label>
    <select id="speedSelect">
        <option value="small">بطيئة</option>
        <option value="medium">متوسطة</option>
        <option value="fast">سريعة</option>
    </select>

    <button id="toggleBtn">ايقاف / تشغيل</button>
</div>

<div id="massControls">
    <label>الكتلة</label>
    <select id="massSelect">
        <option value="small">صغيرة</option>
        <option value="medium">متوسطة</option>
        <option value="large">كبيرة</option>
    </select>
</div>

<canvas id="myCanvas"></canvas>

<script>
const canvas = document.getElementById("myCanvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resizeCanvas();
window.onresize = resizeCanvas;

// المتغيرات الأساسية
let y = 50;
let velocity = 0;
let gravity = 0.3;
let bouncing = 0.75;
let radius = 30;
let mass = 1;
let running = true;

let lastY = y;
let stableCounter = 0;
let grounded = false; // نعرف إذا هي على الأرض

// تحديث الكتلة
function updateMass(v) {
    mass = v === "small" ? 1 : v === "medium" ? 2 : 3;
}

// تحديث السرعة
function updateSpeed(v) {
    gravity = v === "small" ? 0.2 : v === "medium" ? 0.35 : 0.55;
}

document.getElementById("massSelect").onchange = (e)=>{
    updateMass(e.target.value);
    resetBall();
};

document.getElementById("speedSelect").onchange = (e)=>{
    updateSpeed(e.target.value);
    resetBall();
};

document.getElementById("toggleBtn").onclick = ()=>{
    running = !running;
};

function resetBall(){
    y = 50;
    velocity = 0;
    grounded = false;
    stableCounter = 0;
}

// رسم الكرة
function drawBall(){
    ctx.beginPath();
    ctx.arc(canvas.width/2, y, radius, 0, Math.PI*2);
    ctx.fillStyle = "#3b82f6";
    ctx.fill();
}

// رسم النص فوق الكرة
function drawText(){
    ctx.font = "20px Arial";
    ctx.fillStyle = "black";

    let momentum = velocity * mass;

    // إذا الكرة واقفة على الأرض + مستقرة → صفر
    if (grounded && Math.abs(velocity) < 0.01) {
        momentum = 0;
        velocity = 0;
    }

    ctx.fillText("السرعة: " + velocity.toFixed(2), canvas.width/2 - 50, y - radius - 20);
    ctx.fillText("الزخم: " + momentum.toFixed(2), canvas.width/2 - 50, y - radius - 45);
}

// المحاكاة
function simulate(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    if (running){
        velocity += gravity;
        y += velocity;

        // الأرضية
        if (y + radius >= canvas.height){
            y = canvas.height - radius;
            velocity *= -bouncing;

            grounded = true;

            // لو الارتداد بسيط جدًا → تعتبر واقفة
            if (Math.abs(velocity) < 0.15){
                velocity = 0;
            }
        } else {
            grounded = false;
        }
    }

    // كشف الثبات
    if (Math.abs(y - lastY) < 0.05){
        stableCounter++;
    } else {
        stableCounter = 0;
    }

    lastY = y;

    // إذا مستقرة وملامسة الأرض → سرعة = صفر
    if (grounded && stableCounter > 8){
        velocity = 0;
    }

    drawBall();
    drawText();

    requestAnimationFrame(simulate);
}

simulate();
</script>

</body>
</html>




















