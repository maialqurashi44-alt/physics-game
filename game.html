<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Simulation</title>
<style>
    body {
        margin: 0;
        background: #f5f5f5;
        font-family: sans-serif;
        overflow: hidden;
    }

    #controls {
        position: absolute;
        left: 10px;
        top: 10px;
        background: white;
        padding: 12px;
        border-radius: 12px;
        box-shadow: 0 0 10px #0002;
        z-index: 10;
    }

    #massControls {
        position: absolute;
        right: 10px;
        top: 10px;
        background: white;
        padding: 12px;
        border-radius: 12px;
        box-shadow: 0 0 10px #0002;
        z-index: 10;
    }

    button, select {
        padding: 8px;
        margin: 5px 0;
        width: 100%;
        border-radius: 8px;
        border: 1px solid #ccc;
    }

    canvas {
        background: #eee;
        display: block;
    }

    .label {
        font-size: 14px;
        margin-bottom: 6px;
        font-weight: bold;
    }
</style>
</head>
<body>

<div id="controls">
    <div class="label">السرعة</div>
    <select id="speedSelect">
        <option value="small">بطيئة</option>
        <option value="medium">متوسطة</option>
        <option value="fast">سريعة</option>
    </select>

    <button id="toggleBtn">ايقاف / تشغيل</button>
</div>

<div id="massControls">
    <div class="label">الكتلة</div>
    <select id="massSelect">
        <option value="small">صغيرة</option>
        <option value="medium">متوسطة</option>
        <option value="large">كبيرة</option>
    </select>
</div>

<canvas id="myCanvas"></canvas>

<script>
const canvas = document.getElementById("myCanvas");
const ctx = canvas.getContext("2d");

function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resizeCanvas();
window.onresize = resizeCanvas;

let y = 50;
let velocity = 0;
let gravity = 0.3;
let bouncing = 0.75;
let radius = 30;
let mass = 1;
let running = true;

let lastY = y;
let stableCounter = 0;

function updateMass(value) {
    if (value === "small") mass = 1;
    if (value === "medium") mass = 2;
    if (value === "large") mass = 3;
}

function updateSpeed(value) {
    if (value === "small") gravity = 0.2;
    if (value === "medium") gravity = 0.35;
    if (value === "fast") gravity = 0.55;
}

document.getElementById("massSelect").onchange = (e) => {
    updateMass(e.target.value);
    resetBall();
};

document.getElementById("speedSelect").onchange = (e) => {
    updateSpeed(e.target.value);
    resetBall();
};

document.getElementById("toggleBtn").onclick = () => {
    running = !running;
};

function resetBall() {
    y = 50;
    velocity = 0;
}

function drawBall() {
    ctx.beginPath();
    ctx.arc(canvas.width / 2, y, radius, 0, Math.PI * 2);
    ctx.fillStyle = "#3b82f6";
    ctx.fill();
    ctx.closePath();
}

function drawText() {
    ctx.font = "20px Arial";
    ctx.fillStyle = "black";

    // الحركة فوق الكرة
    ctx.fillText("السرعة: " + velocity.toFixed(2), canvas.width / 2 - 50, y - radius - 20);
    
    let momentum = velocity * mass;

    // لو وقفت الكرة نخلي الاثنين صفر
    if (Math.abs(velocity) < 0.001) {
        momentum = 0;
    }

    ctx.fillText("الزخم: " + momentum.toFixed(2), canvas.width / 2 - 50, y - radius - 45);
}

function simulate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (running) {
        velocity += gravity;
        y += velocity;

        if (y + radius > canvas.height) {
            y = canvas.height - radius;
            velocity *= -bouncing;

            // سطح مرن وسهل على الجوال
            if (Math.abs(velocity) < 0.15) {
                velocity = 0;
            }
        }
    }

    // كشف إذا الكورة وقفت
    if (Math.abs(y - lastY) < 0.05) {
        stableCounter++;
    } else {
        stableCounter = 0;
    }

    lastY = y;

    // لو سكنت تماماً
    if (stableCounter > 8) {
        velocity = 0;
    }

    drawBall();
    drawText();

    requestAnimationFrame(simulate);
}

simulate();
</script>

</body>
</html>















